UserParameter=hyperv.discovery,powershell.exe -file "C:\Program Files\Zabbix Agent 2\zabbix-vm-perf.ps1"
UserParameter=hyperv.discoveryitem[*],powershell.exe -file "C:\Program Files\Zabbix Agent 2\zabbix-vm-perf.ps1" "$1" "$2"
UserParameter=hyperv.check[*],powershell.exe -file "C:\Program Files\Zabbix Agent 2\zabbix-vm-perf.ps1" "$1" "$2" "$3"

# Optimized Hyper-V monitoring with separate counter discovery
# VM discovery is kept simple, counter discovery is done per VM when needed
UserParameter=hyperv.discovery2025,powershell.exe -file "C:\Program Files\Zabbix Agent 2\hyper-v-monitoring.ps1"
UserParameter=hyperv.vm.counters[*],powershell.exe -file "C:\Program Files\Zabbix Agent 2\hyper-v-monitoring.ps1" "DiscoverVMCounters" "$1"
UserParameter=hyperv.counter[*],powershell.exe -file "C:\Program Files\Zabbix Agent 2\hyper-v-monitoring.ps1" "GetCounterValue" -CounterPath "$1"
UserParameter=hyperv.vm.status[*],powershell.exe -file "C:\Program Files\Zabbix Agent 2\hyper-v-monitoring.ps1" "GetVMStatus" "$1"
UserParameter=hyperv.vm.replication[*],powershell.exe -file "C:\Program Files\Zabbix Agent 2\hyper-v-monitoring.ps1" "GetVMReplication" "$1"
UserParameter=hyperv.vm.cpu.usage[*],powershell.exe -file "C:\Program Files\Zabbix Agent 2\hyper-v-monitoring.ps1" "GetCounterValue" "$1" -CounterPath "$2"
UserParameter=hyperv.vm.disk.usage[*],powershell.exe -file "C:\Program Files\Zabbix Agent 2\hyper-v-monitoring.ps1" "GetCounterValue" "$1" -CounterPath "$2"
UserParameter=hyperv.vm.nic.usage[*],powershell.exe -file "C:\Program Files\Zabbix Agent 2\hyper-v-monitoring.ps1" "GetCounterValue" "$1" -CounterPath "$2"
