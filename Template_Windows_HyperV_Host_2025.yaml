zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 0b4d87047ee14edb98a87b309ee5a803
      name: 'HyperV VM'
    - uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
    - uuid: aea23489ce3a49b6806ebb28e0cda430
      name: Windows
  templates:
    - uuid: 553c9735a18645849c38ebda859ace9c
      template: 'Template Windows HyperV VM Guest 2025'
      name: 'Template Windows HyperV VM Guest 2025'
      description: 'Child template, to create new Hyper-V VM monitoring from the Template Windows HyperV Host 2025 template'
      groups:
        - name: 'HyperV VM'
        - name: Templates
        - name: Windows
      discovery_rules:
        - uuid: 7dbe8007d42e4111aab6f6068e548de7
          name: 'Hyper-V VM CPU Discovery'
          key: 'hyperv.discoveryitem[GetVMCPUs,{HOST.HOST}]'
          delay: 10m
          status: DISABLED
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Hyper-V VM virtual CPU discovery'
          item_prototypes:
            - uuid: a1432f45518b4ea38851af1bb4464522
              name: 'Hyper-V VM Virtual CPU {#VMCPU} Total'
              key: 'hyperv.check[VMCPUTotal,{HOST.HOST},"{#VMCPU}"]'
              history: 30d
              units: '%'
              description: 'Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM'
              timeout: 30s
          graph_prototypes:
            - uuid: fc7e8f33b6104f7fa04ccbf9392556c3
              name: 'Hyper-V VM Virtual CPU {#VMCPU} Total'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 00BB00
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.check[VMCPUTotal,{HOST.HOST},"{#VMCPU}"]'
          timeout: 30s
        - uuid: 97aadaa6e5c94e5f9efe0254b763b8cd
          name: 'Hyper-V VM Virtual Disk Discovery'
          key: 'hyperv.discoveryitem[GetVMDisks,{HOST.HOST}]'
          delay: 10m
          status: DISABLED
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Hyper-V VM virtual disk discovery'
          item_prototypes:
            - uuid: 501fc210d94d43808146f6d4d9cc0362
              name: 'Hyper-V VM Virtual Disk {#VMDISK} Bytes Read'
              key: 'hyperv.check[VMDISKBytesRead,{HOST.HOST},"{#VMDISK}"]'
              history: 30d
              units: Bytes
              description: 'Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM'
              timeout: 30s
            - uuid: 773f2ce4fda94eecbe62c2b0cccfa620
              name: 'Hyper-V VM Virtual Disk {#VMDISK} Bytes Write'
              key: 'hyperv.check[VMDISKBytesWrite,{HOST.HOST},"{#VMDISK}"]'
              history: 30d
              units: Bytes
              description: 'Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM'
              timeout: 30s
            - uuid: db13330ba3a24e51bf58a84a83392e93
              name: 'Hyper-V VM Virtual Disk {#VMDISK} IOPS Read'
              key: 'hyperv.check[VMDISKOpsRead,{HOST.HOST},"{#VMDISK}"]'
              history: 30d
              units: ops
              description: 'Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM'
              timeout: 30s
            - uuid: 95842020af05435ca64723b8f7f73e01
              name: 'Hyper-V VM Virtual Disk {#VMDISK} IOPS Write'
              key: 'hyperv.check[VMDISKOpsWrite,{HOST.HOST},"{#VMDISK}"]'
              history: 30d
              units: ops
              description: 'Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM'
              timeout: 30s
          graph_prototypes:
            - uuid: df4ae549a96548ab9bdad9a95306bc4b
              name: 'Hyper-V VM Virtual Disk {#VMDISK_SHORT} Performance'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 00CC00
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.check[VMDISKBytesRead,{HOST.HOST},"{#VMDISK}"]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 0000CC
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.check[VMDISKBytesWrite,{HOST.HOST},"{#VMDISK}"]'
                - sortorder: '2'
                  drawtype: BOLD_LINE
                  color: 00BBBB
                  yaxisside: RIGHT
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.check[VMDISKOpsRead,{HOST.HOST},"{#VMDISK}"]'
                - sortorder: '3'
                  drawtype: BOLD_LINE
                  color: DD00DD
                  yaxisside: RIGHT
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.check[VMDISKOpsWrite,{HOST.HOST},"{#VMDISK}"]'
          timeout: 30s
        - uuid: 5ec664764cce4e598fa27b74812371bb
          name: 'Hyper-V VM Virtual NIC Discovery'
          key: 'hyperv.discoveryitem[GetVMNICs,{HOST.HOST}]'
          delay: 10m
          status: DISABLED
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          description: 'Hyper-V VM virtual network adapter discovery'
          item_prototypes:
            - uuid: 4fffa08b52cb4254aa8dbcaf3c9fc2a7
              name: 'Hyper-V VM VNIC {#VMNIC} Bytes Recvd'
              key: 'hyperv.check[VMNICRecv,{HOST.HOST},"{#VMNIC}"]'
              history: 30d
              units: Bytes
              description: 'Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM'
              timeout: 30s
            - uuid: 4dd5c14050af47dcb2a5b692fe0a9a6d
              name: 'Hyper-V VM VNIC {#VMNIC} Bytes Sent'
              key: 'hyperv.check[VMNICSent,{HOST.HOST},"{#VMNIC}"]'
              history: 30d
              units: Bytes
              description: 'Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM'
              timeout: 30s
          graph_prototypes:
            - uuid: 42f3e5b7a7a64482b4982519afd7fe4d
              name: 'Hyper-V VM {#VMNIC_SHORT} Network usage'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 0000DD
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.check[VMNICRecv,{HOST.HOST},"{#VMNIC}"]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 00C800
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.check[VMNICSent,{HOST.HOST},"{#VMNIC}"]'
          timeout: 30s
        - uuid: 25a2db5274d241db89da539400514b39
          name: 'Hyper-V VM Performance Counters Discovery'
          key: 'hyperv.vm.counters[{HOST.HOST}]'
          delay: 1h
          description: |
            Discovers all performance counters (CPU, Disk, NIC) for this Hyper-V VM
            Needs to be passive Zabbix Agent
          item_prototypes:
            - uuid: c3546c20f1874f6daa325e7ed99d9d67
              name: 'Hyper-V VM Counters Master Data - {#VMNAME}'
              key: 'hyperv.vm.counters.master[{#VMNAME_SAFE}_{#VMHOST}]'
              delay: 5m
              history: '0'
              value_type: TEXT
              trends: '0'
              description: |
                Master item containing all counter discovery data for dependent items
                
                Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM
              timeout: 30s
            - uuid: 1ee84ced5bed4caaa059ee4dc431c30d
              name: 'Hyper-V CPU Usage - {#VMNAME} - {#INSTANCE}'
              type: DEPENDENT
              key: 'hyperv.vm.cpu.usage[{#VMNAME_SAFE},{#INSTANCE}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                CPU usage for virtual processor {#INSTANCE}
                
                Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data[?(@[''''{#ITEM_TYPE}'''']==''''CPU'''' && @[''''{#INSTANCE}'''']==''''{#INSTANCE}'''')][''''{#COUNTER_PATH}''''].first()'
                - type: REGEX
                  parameters:
                    - \\\\
                    - \
                - type: JAVASCRIPT
                  parameters:
                    - 'return Zabbix.call("perf_counter_en", [value, "60"]);'
              master_item:
                key: 'hyperv.vm.counters.master[{#VMNAME_SAFE}_{#VMHOST}]'
            - uuid: e6d4cc5cf10847df82fd28fcae6b8e0d
              name: 'Hyper-V Disk Read Bytes/sec - {#VMNAME} - {#DISK_SHORT}'
              type: DEPENDENT
              key: 'hyperv.vm.disk.read.bytes[{#VMNAME_SAFE},{#DISK_SHORT}]'
              delay: '0'
              value_type: FLOAT
              units: Bps
              description: |
                Disk read bytes per second for {#DISK_SHORT}
                
                Needs to be passive agent, as the request must be processed by the Hyper-V server itself and not the VM
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data[?(@[''''{#ITEM_TYPE}'''']==''''DISK'''' && @[''''{#METRIC}'''']==''''ReadBytes'''' && @[''''{#DISK_SHORT}'''']==''''{#DISK_SHORT}'''')][''''{#COUNTER_PATH}''''].first()'
                - type: REGEX
                  parameters:
                    - \\\\
                    - \
                - type: JAVASCRIPT
                  parameters:
                    - 'return Zabbix.call("perf_counter_en", [value, "60"]);'
              master_item:
                key: 'hyperv.vm.counters.master[{#VMNAME_SAFE}_{#VMHOST}]'
            - uuid: a063194d032b4380adc4f11f88a1c334
              name: 'Hyper-V Disk Read Ops/sec - {#VMNAME} - {#DISK_SHORT}'
              type: DEPENDENT
              key: 'hyperv.vm.disk.read.ops[{#VMNAME_SAFE},{#DISK_SHORT}]'
              delay: '0'
              value_type: FLOAT
              units: ops/sec
              description: 'Disk read operations per second for {#DISK_SHORT}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data[?(@[''''{#ITEM_TYPE}'''']==''''DISK'''' && @[''''{#METRIC}'''']==''''ReadOps'''' && @[''''{#DISK_SHORT}'''']==''''{#DISK_SHORT}'''')][''''{#COUNTER_PATH}''''].first()'
                - type: REGEX
                  parameters:
                    - \\\\
                    - \
                - type: JAVASCRIPT
                  parameters:
                    - 'return Zabbix.call("perf_counter_en", [value, "60"]);'
              master_item:
                key: 'hyperv.vm.counters.master[{#VMNAME_SAFE}_{#VMHOST}]'
            - uuid: 89c87bd744e840c3b9c51abafa74ffec
              name: 'Hyper-V Disk Write Bytes/sec - {#VMNAME} - {#DISK_SHORT}'
              type: DEPENDENT
              key: 'hyperv.vm.disk.write.bytes[{#VMNAME_SAFE},{#DISK_SHORT}]'
              delay: '0'
              value_type: FLOAT
              description: 'Disk write bytes per second for {#DISK_SHORT}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data[?(@[''''{#ITEM_TYPE}'''']==''''DISK'''' && @[''''{#METRIC}'''']==''''WriteBytes'''' && @[''''{#DISK_SHORT}'''']==''''{#DISK_SHORT}'''')][''''{#COUNTER_PATH}''''].first()'
                - type: REGEX
                  parameters:
                    - \\\\
                    - \
                - type: JAVASCRIPT
                  parameters:
                    - 'return Zabbix.call("perf_counter_en", [value, "60"]);'
              master_item:
                key: 'hyperv.vm.counters.master[{#VMNAME_SAFE}_{#VMHOST}]'
            - uuid: 792dc09811634227bb78dc4c47f6c998
              name: 'Hyper-V Disk Write Ops/sec - {#VMNAME} - {#DISK_SHORT}'
              type: DEPENDENT
              key: 'hyperv.vm.disk.write.ops[{#VMNAME_SAFE},{#DISK_SHORT}]'
              delay: '0'
              value_type: FLOAT
              units: ops/sec
              description: 'Disk write operations per second for {#DISK_SHORT}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data[?(@[''''{#ITEM_TYPE}'''']==''''DISK'''' && @[''''{#METRIC}'''']==''''WriteOps'''' && @[''''{#DISK_SHORT}'''']==''''{#DISK_SHORT}'''')][''''{#COUNTER_PATH}''''].first()'
                - type: REGEX
                  parameters:
                    - \\\\
                    - \
                - type: JAVASCRIPT
                  parameters:
                    - 'return Zabbix.call("perf_counter_en", [value, "60"]);'
              master_item:
                key: 'hyperv.vm.counters.master[{#VMNAME_SAFE}_{#VMHOST}]'
            - uuid: 36c61ccc143b4dfb853ba1988938cadc
              name: 'Hyper-V NIC Bytes Received/sec - {#VMNAME} - {#NIC_SHORT}'
              type: DEPENDENT
              key: 'hyperv.vm.nic.bytes.received[{#VMNAME_SAFE},{#NIC_SHORT}]'
              delay: '0'
              value_type: FLOAT
              units: Bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data[?(@[''''{#ITEM_TYPE}'''']==''''NIC'''' && @[''''{#METRIC}'''']==''''BytesReceived'''' && @[''''{#NIC_SHORT}'''']==''''{#NIC_SHORT}'''')][''''{#COUNTER_PATH}''''].first()'
                - type: REGEX
                  parameters:
                    - \\\\
                    - \
                - type: JAVASCRIPT
                  parameters:
                    - 'return Zabbix.call("perf_counter_en", [value, "60"]);'
              master_item:
                key: 'hyperv.vm.counters.master[{#VMNAME_SAFE}_{#VMHOST}]'
            - uuid: 74e4dd75d6234b8c870c65c86472e9d9
              name: 'Hyper-V NIC Bytes Sent/sec - {#VMNAME} - {#NIC_SHORT}'
              type: DEPENDENT
              key: 'hyperv.vm.nic.bytes.sent[{#VMNAME_SAFE},{#NIC_SHORT}]'
              delay: '0'
              value_type: FLOAT
              units: bps
              description: 'Network bytes sent per second for {#NIC_SHORT}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data[?(@[''''{#ITEM_TYPE}'''']==''''NIC'''' && @[''''{#METRIC}'''']==''''BytesSent'''' && @[''''{#NIC_SHORT}'''']==''''{#NIC_SHORT}'''')][''''{#COUNTER_PATH}''''].first()'
                - type: REGEX
                  parameters:
                    - \\\\
                    - \
                - type: JAVASCRIPT
                  parameters:
                    - 'return Zabbix.call("perf_counter_en", [value, "60"]);'
              master_item:
                key: 'hyperv.vm.counters.master[{#VMNAME_SAFE}_{#VMHOST}]'
            - uuid: cec9828b76614fc4ab501caaa1a02a3c
              name: 'Hyper-V NIC Packets Sent/sec - {#VMNAME} - {#NIC_SHORT}'
              type: DEPENDENT
              key: 'hyperv.vm.nic.packets.sent[{#VMNAME_SAFE},{#NIC_SHORT}]'
              delay: '0'
              value_type: FLOAT
              units: pps
              description: 'Network packets sent per second for {#NIC_SHORT}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data[?(@[''''{#ITEM_TYPE}'''']==''''NIC'''' && @[''''{#METRIC}'''']==''''PacketsSent'''' && @[''''{#NIC_SHORT}'''']==''''{#NIC_SHORT}'''')][''''{#COUNTER_PATH}''''].first()'
                - type: REGEX
                  parameters:
                    - \\\\
                    - \
                - type: JAVASCRIPT
                  parameters:
                    - 'return Zabbix.call("perf_counter_en", [value, "60"]);'
              master_item:
                key: 'hyperv.vm.counters.master[{#VMNAME_SAFE}_{#VMHOST}]'
          graph_prototypes:
            - uuid: aa79e59b262840d3ab8eb2d02576058e
              name: 'Hyper-V VM CPU Usage - {#VMNAME}'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.vm.cpu.usage[{#VMNAME_SAFE},{#INSTANCE}]'
            - uuid: 4a90d9cb53bb4acbb9fdef675f8d1724
              name: 'Hyper-V VM Disk Performance - {#VMNAME} - {#DISK_SHORT}'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.vm.disk.read.bytes[{#VMNAME_SAFE},{#DISK_SHORT}]'
                - sortorder: '1'
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.vm.disk.read.ops[{#VMNAME_SAFE},{#DISK_SHORT}]'
                - sortorder: '2'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.vm.disk.write.bytes[{#VMNAME_SAFE},{#DISK_SHORT}]'
                - sortorder: '3'
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.vm.disk.write.ops[{#VMNAME_SAFE},{#DISK_SHORT}]'
            - uuid: b610b0751eff46098eff935ce5f37577
              name: 'Hyper-V VM Network Usage - {#VMNAME} - {#NIC_SHORT}'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.vm.nic.bytes.received[{#VMNAME_SAFE},{#NIC_SHORT}]'
                - sortorder: '1'
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.vm.nic.bytes.sent[{#VMNAME_SAFE},{#NIC_SHORT}]'
                - sortorder: '2'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Template Windows HyperV VM Guest 2025'
                    key: 'hyperv.vm.nic.packets.sent[{#VMNAME_SAFE},{#NIC_SHORT}]'
          timeout: 30s
      tags:
        - tag: class
          value: software
        - tag: target
          value: hyperv
        - tag: target
          value: hyperv-client
